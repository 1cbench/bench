{
  "task": "Создай функцию ВыгрузитьОстаткиСклада(Склад, МинимальныйОстаток, ФайлJson), которая получает остаки товаров склада на текущую дату из регистра ТоварныеЗапасы у которых остаток больше или равен значению МинимальныйОстаток. Записать файл в json формате как список с полями \"Товар_Код\", \"Товар_Наименование\", \"Остаток\" (число, округленное до целого). Строки списка должны быть упорядочены по возрастанию поля Товар_Код",
  "context": "{\n  \"AccumulationRegisters\": [\n    {\n      \"id\": \"ТоварныеЗапасы\",\n      \"name\": \"Товарные запасы\",\n      \"RegisterType\": \"Balance\",\n      \"Dimensions\": [\n        {\n          \"id\": \"Товар\",\n          \"name\": \"Товар\",\n          \"types\": [\n            {\n              \"type\": \"Ref\",\n              \"id\": \"Справочник.Товары\"\n            }\n          ]\n        },\n        {\n          \"id\": \"Склад\",\n          \"name\": \"Склад\",\n          \"types\": [\n            {\n              \"type\": \"Ref\",\n              \"id\": \"Справочник.Склады\"\n            }\n          ]\n        }\n      ],\n      \"Resources\": [\n        {\n          \"id\": \"Количество\",\n          \"name\": \"Количество\",\n          \"types\": [\n            {\n              \"type\": \"Number\",\n              \"NumberQualifiers\": \"10.2\"\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}",
  "validation": "Функция ЗадачаРешена(ФайлJson) Экспорт\n\t\n\tОжидаемыеДанные = Новый Массив;\n\n\t// Только товары с остатком >= 60\n\tСтрокаТовар = Новый Структура;\n\tСтрокаТовар.Вставить(\"Товар_Код\", \"000000026\");\n\tСтрокаТовар.Вставить(\"Товар_Наименование\", \"Молоко\");\n\tСтрокаТовар.Вставить(\"Остаток\", 100);\n\tОжидаемыеДанные.Добавить(СтрокаТовар);    \n\t\n\tСтрокаТовар = Новый Структура;\n\tСтрокаТовар.Вставить(\"Товар_Код\", \"000000032\");\n\tСтрокаТовар.Вставить(\"Товар_Наименование\", \"Торт\");\n\tСтрокаТовар.Вставить(\"Остаток\", 100);\n\tОжидаемыеДанные.Добавить(СтрокаТовар);\n\n\tСтрокаТовар = Новый Структура;\n\tСтрокаТовар.Вставить(\"Товар_Код\", \"000000033\");\n\tСтрокаТовар.Вставить(\"Товар_Наименование\", \"VekoNT02\");\n\tСтрокаТовар.Вставить(\"Остаток\", 195);\n\tОжидаемыеДанные.Добавить(СтрокаТовар);\n\n\t// Проверяем существование файла\n\tФайлОбъект = Новый Файл(ФайлJson);\n\tЕсли НЕ ФайлОбъект.Существует() Тогда\n\t\tВозврат Ложь;\n\tКонецЕсли;\n\n\t// Читаем JSON из файла\n\tЧтениеJSON = Новый ЧтениеJSON;\n\tЧтениеJSON.ОткрытьФайл(ФайлJson);\n\tМассивДанных = ПрочитатьJSON(ЧтениеJSON);\n\tЧтениеJSON.Закрыть();\n\n\t// Проверяем тип результата\n\tЕсли ТипЗнч(МассивДанных) <> Тип(\"Массив\") Тогда\n\t\tВозврат Ложь;\n\tКонецЕсли;\n\n\t// Проверяем количество элементов\n\tЕсли МассивДанных.Количество() <> 4 Тогда\n\t\tВозврат Ложь;\n\tКонецЕсли;\n\n\t// Проверяем каждый элемент\n\tДля Индекс = 0 По 2 Цикл\n\t\tФактическаяСтрока = МассивДанных[Индекс];\n\t\tОжидаемаяСтрока = ОжидаемыеДанные[Индекс];\n\n\t\t// Проверяем наличие обязательных полей\n\t\tЕсли НЕ ФактическаяСтрока.Свойство(\"Товар_Код\")\n\t\t\tИЛИ НЕ ФактическаяСтрока.Свойство(\"Товар_Наименование\")\n\t\t\tИЛИ НЕ ФактическаяСтрока.Свойство(\"Остаток\") Тогда\n\t\t\tВозврат Ложь;\n\t\tКонецЕсли;\n\n\t\t// Проверяем значения полей\n\t\tЕсли ФактическаяСтрока.Товар_Код <> ОжидаемаяСтрока.Товар_Код\n\t\t\tИЛИ ФактическаяСтрока.Товар_Наименование <> ОжидаемаяСтрока.Товар_Наименование\n\t\t\tИЛИ ФактическаяСтрока.Остаток <> ОжидаемаяСтрока.Остаток Тогда\n\t\t\tВозврат Ложь;\n\t\tКонецЕсли;\n\n\t\t// Проверяем, что остаток - целое число\n\t\tЕсли ФактическаяСтрока.Остаток <> Окр(ФактическаяСтрока.Остаток, 0) Тогда\n\t\t\tВозврат Ложь;\n\t\tКонецЕсли;\n\tКонецЦикла;\n\n\tВозврат Истина;\n\nКонецФункции\n",
  "gt_solution": "Функция ВыгрузитьОстаткиСклада(Склад, МинимальныйОстаток, ФайлJson) Экспорт\n\n\t// Запрос для получения остатков товаров на складе\n\tЗапрос = Новый Запрос;\n\tЗапрос.Текст =\n\t\"ВЫБРАТЬ\n\t|\tОстатки.Товар.Код КАК Товар_Код,\n\t|\tОстатки.Товар.Наименование КАК Товар_Наименование,\n\t|\tОстатки.КоличествоОстаток КАК Остаток\n\t|ИЗ\n\t|\tРегистрНакопления.ТоварныеЗапасы.Остатки(&ТекущаяДата, Склад = &Склад) КАК Остатки\n\t|ГДЕ\n\t|\tОстатки.КоличествоОстаток >= &МинимальныйОстаток\n\t|УПОРЯДОЧИТЬ ПО\n\t|\tТовар_Код\";\n\n\tЗапрос.УстановитьПараметр(\"ТекущаяДата\", ТекущаяДатаСеанса());\n\tЗапрос.УстановитьПараметр(\"Склад\", Склад);\n\tЗапрос.УстановитьПараметр(\"МинимальныйОстаток\", МинимальныйОстаток);\n\n\tРезультат = Запрос.Выполнить();\n\tВыборка = Результат.Выбрать();\n\n\t// Формируем массив для JSON\n\tМассивДанных = Новый Массив;\n\n\tПока Выборка.Следующий() Цикл\n\t\tСтрокаДанных = Новый Структура;\n\t\tСтрокаДанных.Вставить(\"Товар_Код\", Выборка.Товар_Код);\n\t\tСтрокаДанных.Вставить(\"Товар_Наименование\", Выборка.Товар_Наименование);\n\t\tСтрокаДанных.Вставить(\"Остаток\", Окр(Выборка.Остаток, 0, РежимОкругления.Окр15как20));\n\n\t\tМассивДанных.Добавить(СтрокаДанных);\n\tКонецЦикла;\n\n\t// Записываем JSON в файл\n\tЗаписьJSON = Новый ЗаписьJSON;\n\tЗаписьJSON.ОткрытьФайл(ФайлJson);\n\tЗаписатьJSON(ЗаписьJSON, МассивДанных);\n\tЗаписьJSON.Закрыть();\n\n\tВозврат Истина;\n\nКонецФункции\n",
  "run_context": "Функция ЗапуститьРешение() Экспорт\n\n\t// Подготовка тестовых данных: создаём склад\n\tСклад = Справочники.Склады.НайтиПоНаименованию(\"Склад отдела продаж\");\n\n\t// Формируем ожидаемые данные (минимальный остаток = 10)\n\tМинимальныйОстаток = 60; \n\t\n\t// Путь к файлу JSON\n\tФайлJson = ПолучитьИмяВременногоФайла(\"json\");\n\n\t// Вызов функции задачи\n\tВыгрузитьОстаткиСклада(Склад, МинимальныйОстаток, ФайлJson);\n\n\t// Вызов функции валидатора для проверки решения задачи\n\tРезультатПроверки = ЗадачаРешена(ФайлJson);\n\n\t// Удаляем временный файл JSON\n\tПопытка\n\t\tУдалитьФайлы(ФайлJson);\n\tИсключение\n\t\t// Игнорируем ошибки удаления файла\n\tКонецПопытки;\n\n\tВозврат РезультатПроверки;\n\nКонецФункции\n"
}