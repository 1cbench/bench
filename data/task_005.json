{
  "task": "Создай функцию НеУстановленыЦены(Поставщик) которая возвращает СписокЗначений с элементами справочника Товары у которых Поставщик = Поставщик и нет записи в регистре сведений ЦеныТоваров",
  "context": "{\n  \"InformationRegisters\": [\n    {\n      \"id\": \"ЦеныТоваров\",\n      \"name\": \"Цены товаров\",\n      \"InformationRegisterPeriodicity\": \"Day\",\n      \"WriteMode\": \"Independent\",\n      \"Dimensions\": [\n        {\n          \"id\": \"Товар\",\n          \"name\": \"Товар\",\n          \"types\": [\n            {\n              \"type\": \"Ref\",\n              \"id\": \"Справочник.Товары\"\n            }\n          ]\n        },\n        {\n          \"id\": \"ВидЦен\",\n          \"name\": \"Вид цен\",\n          \"types\": [\n            {\n              \"type\": \"Ref\",\n              \"id\": \"Справочник.ВидыЦен\"\n            }\n          ]\n        }\n      ],\n      \"Resources\": [\n        {\n          \"id\": \"Цена\",\n          \"name\": \"Цена\",\n          \"types\": [\n            {\n              \"type\": \"Number\",\n              \"NumberQualifiers\": \"10.2\"\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}",
  "validation": "Функция ЗадачаРешена(СписокТоваров, ОжидаемыеТовары) Экспорт\n\n\t// Проверяем тип результата\n\tЕсли ТипЗнч(СписокТоваров) <> Тип(\"СписокЗначений\") Тогда\n\t\tВозврат Ложь;\n\tКонецЕсли;\n\n\t// Проверяем количество элементов\n\tЕсли СписокТоваров.Количество() <> ОжидаемыеТовары.Количество() Тогда\n\t\tВозврат Ложь;\n\tКонецЕсли;\n\n\t// Проверяем, что все ожидаемые товары присутствуют в списке\n\tДля Каждого ОжидаемыйТовар Из ОжидаемыеТовары Цикл\n\t\tЭлементСписка = СписокТоваров.НайтиПоЗначению(ОжидаемыйТовар.Значение);\n\t\tЕсли ЭлементСписка = Неопределено Тогда\n\t\t\tВозврат Ложь;\n\t\tКонецЕсли;\n\tКонецЦикла;\n\n\t// Проверяем, что в списке нет лишних товаров\n\tДля Каждого ЭлементСписка Из СписокТоваров Цикл\n\t\tНайден = Ложь;\n\t\tДля Каждого ОжидаемыйТовар Из ОжидаемыеТовары Цикл\n\t\t\tЕсли ЭлементСписка.Значение = ОжидаемыйТовар.Значение Тогда\n\t\t\t\tНайден = Истина;\n\t\t\t\tПрервать;\n\t\t\tКонецЕсли;\n\t\tКонецЦикла;\n\n\t\tЕсли НЕ Найден Тогда\n\t\t\tВозврат Ложь;\n\t\tКонецЕсли;\n\tКонецЦикла;\n\n\tВозврат Истина;\n\nКонецФункции\n",
  "gt_solution": "Функция НеУстановленыЦены(Поставщик) Экспорт\n\n // Запрос для получения товаров поставщика, у которых нет записей в регистре ЦеныТоваров\n Запрос = Новый Запрос;\n Запрос.Текст =\n \"ВЫБРАТЬ\n | Товары.Ссылка КАК Товар\n |ИЗ\n | Справочник.Товары КАК Товары\n |  ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныТоваров КАК ЦеныТоваров\n |  ПО Товары.Ссылка = ЦеныТоваров.Товар\n |ГДЕ\n | Товары.Поставщик = &Поставщик\n | И Товары.ЭтоГруппа = ЛОЖЬ\n | И НЕ Товары.ПометкаУдаления\n | И ЦеныТоваров.Товар ЕСТЬ NULL\n |УПОРЯДОЧИТЬ ПО\n | Товар\";\n\n Запрос.УстановитьПараметр(\"Поставщик\", Поставщик);\n\n Результат = Запрос.Выполнить();\n Выборка = Результат.Выбрать();\n\n // Создаём список значений для возврата\n СписокТоваров = Новый СписокЗначений;\n\n Пока Выборка.Следующий() Цикл\n  СписокТоваров.Добавить(Выборка.Товар);\n КонецЦикла;\n\n Возврат СписокТоваров;\n\nКонецФункции\n",
  "run_context": "Функция ЗапуститьРешение() Экспорт\n\n \t// Подготовка тестовых данных: создаём поставщика\n \tПоставщик = Справочники.Контрагенты.НайтиПоНаименованию(\"Тестовый поставщик\");\n\n\tЕсли Поставщик.Пустая() Тогда\n\t\tПоставщик = Справочники.Контрагенты.СоздатьЭлемент();\n\t\tПоставщик.Наименование = \"Тестовый поставщик\";\n\t\tПоставщик.Записать();\n\t\tПоставщик = Поставщик.Ссылка; \n\tКонецЕсли;    \n\t\n\tДругойПоставщик = Справочники.Контрагенты.НайтиПоНаименованию(\"Другой поставщик\");\n\n\tЕсли ДругойПоставщик.Пустая() Тогда\n\t\tДругойПоставщик = Справочники.Контрагенты.СоздатьЭлемент();\n\t\tДругойПоставщик.Наименование = \"Другой поставщик\";\n\t\tДругойПоставщик.Записать();\n\t\tДругойПоставщик = Поставщик.Ссылка; \n\tКонецЕсли;\n\n\n // Создаём вид цен для теста (если нужен)\n ВидЦен = Справочники.ВидыЦен.НайтиПоНаименованию(\"Базовая\");\n\n Если ВидЦен.Пустая() Тогда\n  ВидЦен = Справочники.ВидыЦен.СоздатьЭлемент();\n  ВидЦен.Наименование = \"Базовая\";\n  ВидЦен.Записать(); \n  ВидЦен = ВидЦен.Ссылка; \n КонецЕсли;\n\n // Создаём товары для теста\n // Товар 1 - с ценой (не должен попасть в список)\n Товар1 = Справочники.Товары.СоздатьЭлемент();\n Товар1.Наименование = \"Товар с ценой\";\n Товар1.Поставщик = Поставщик;\n Товар1.Записать();\n\n МенеджерЦены1 = РегистрыСведений.ЦеныТоваров.СоздатьМенеджерЗаписи();\n МенеджерЦены1.Период = ТекущаяДатаСеанса();\n МенеджерЦены1.Товар = Товар1.Ссылка;\n МенеджерЦены1.ВидЦен = ВидЦен;\n МенеджерЦены1.Цена = 100;\n МенеджерЦены1.Записать();\n\n // Товар 2 - без цены (должен попасть в список)\n Товар2 = Справочники.Товары.СоздатьЭлемент();\n Товар2.Наименование = \"Товар без цены 1\";\n Товар2.Поставщик = Поставщик;\n Товар2.Записать();\n\n // Товар 3 - без цены (должен попасть в список)\n Товар3 = Справочники.Товары.СоздатьЭлемент();\n Товар3.Наименование = \"Товар без цены 2\";\n Товар3.Поставщик = Поставщик;\n Товар3.Записать();\n\n Товар4 = Справочники.Товары.СоздатьЭлемент();\n Товар4.Наименование = \"Товар другого поставщика\";\n Товар4.Поставщик = ДругойПоставщик;\n Товар4.Записать();\n\n // Формируем ожидаемый список товаров без цен\n ОжидаемыеТовары = Новый СписокЗначений;\n ОжидаемыеТовары.Добавить(Товар2.Ссылка);\n ОжидаемыеТовары.Добавить(Товар3.Ссылка);\n\n // Вызов функции задачи\n СписокТоваров = НеУстановленыЦены(Поставщик);\n\n // Вызов функции валидатора для проверки решения задачи\n РезультатПроверки = ЗадачаРешена(СписокТоваров, ОжидаемыеТовары);\n\n // Удаление тестовых данных\n // Удаляем запись регистра цен\n МенеджерУдаления = РегистрыСведений.ЦеныТоваров.СоздатьМенеджерЗаписи();\n МенеджерУдаления.Период = МенеджерЦены1.Период;\n МенеджерУдаления.Товар = Товар1.Ссылка;\n МенеджерУдаления.ВидЦен = ВидЦен;\n МенеджерУдаления.Удалить();\n\n // Удаляем товары\n Товар1.Удалить();\n Товар2.Удалить();\n Товар3.Удалить();\n Товар4.Удалить();\n\n // Удаляем контрагентов\n Поставщик.ПолучитьОбъект().Удалить();\n ДругойПоставщик.ПолучитьОбъект().Удалить();\n\n // Удаляем вид цен\n ВидЦен.ПолучитьОбъект().Удалить();\n\n Возврат РезультатПроверки;\n\nКонецФункции\n"
}